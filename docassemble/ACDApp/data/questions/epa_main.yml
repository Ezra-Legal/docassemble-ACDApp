 include:
  - epa_constants.yml
  - epa_questions_donor.yml
  - epa_questions_donees.yml
  - epa_questions_alternates.yml
  - epa_formatted_output.yml
  - epa_execution.yml
  - epa_acceptance.yml
  - sales_pitch.yml
  - epa_attachments.yml
#   - acd_questions_epaDonor.yml
#   - acd_questions_part2.yml
#   - acd_questions_part3.yml
#   - acd_questions_part4.yml
#   - acd_questions_part5.yml
#   - acd_questions_part6.yml
#   - acd_attachment.yml
---
# Logo
objects:
  - EzraLogo: DAStaticFile.using(filename="Ezra-Legal-Logo-web-white-orange.png")
---
# Does some magic with the logo
code: |
  ACDlogo = '<div class="media"><img src="{}" class="mr-3" height="40"><div class="media-body"></div></div>'.format(EzraLogo.url_for())
  set_parts(logo=ACDlogo)
 
  # Make the the title/logo function as a clickable link to restart the
  # app.
  log(
    "var dapagetitle = $('#dapagetitle');" +
    "function confirmAndRestart() {" +
    "  var restart = confirm('This will return you to the home page, clearing the current report. Are you sure you want to restart?');" +
    "  if (restart) {" +
    "    window.location.href = '" + url_of('restart') + "';" +
    "  }" +
    "}" +
    "dapagetitle.attr('href', 'javascript:confirmAndRestart()');" +
    "dapagetitle.attr('title', 'Restart & return to home page')",
    "javascript"
  )
  logo_code = True
---
features:
  css: ACDApp.css
  question back button: True
  navigation back button: False
---
default screen parts:
  post: |
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Unna&display=swap" rel="stylesheet">
---
# Welcome Screen
mandatory: true
question: Enhanced Power of Attorney Form
subquestion: |
  A description will go here

  **Disclaimer**

  This app is not a substitute for legal advice.  If you would like help completing your
  Enhanced Power of Attorney please [contact us](https://ezralegal.com.au/contact-us/)
buttons: 
  - Continue: continue
  - Exit: exit
    url: https://ezralegal.com.au
---
# This is the code block that drives everything
mandatory: True
code: |
  # Set the logo stuff
  logo_code

  # Get Donor's details
  epaDonor.name.first

  # Get the donees and alternates
  for an_item in epaDonees + epaAlternates:
    an_item

  # Get execution
  epaEffective

  # Run the sales pitch
  get_in_touch

  # Send the email if contacted along with the
  # generated EPA

  # The rest of the app is driven by the fields in the
  # acd_form
  final_screen
---
event: final_test
question: Test end screen
subquestion: |
  End screen for testing

  **Donor**: ${ epaDonor }

  **Donees**: ${ epaDonees }

  **Alterates** ${ epaAlternates }

  **Donor Clause:**: ${donor_clause}

  **Donee Clause**: ${donee_clause}

  **Donee list**: ${ epaDoneeNamesList }

  **Customer**: ${ epaCustomer }

attachment:
  - docx template file: EPA_base.docx
    valid formats:
      - pdf
---
event: final_screen
question: Your Enhanced Power of Attorney
subquestion: |
  Your Enhanced Power of Attorney is ready for you to download, print and sign.

  % if get_in_touch and email_sent:
  Thanks for getting in touch.  We will get back to you soon!
  % elif get_in_touch and not email_sent:
  Unfortunately there was an isue sending your email.  Please
  [contact us](https://ezralegal.com.au/contact-us/).
  %endif

  <hr>
  **Click on the image below to download and print your Power of Attorney**

  ${ epa_final }
buttons: 
  - Exit: exit
    url: https://ezralegal.com.au
  - Restart: restart
---